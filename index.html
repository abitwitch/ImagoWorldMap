<!DOCTYPE html>
<meta charset="utf-8">
<style>

/* path {
  fill: #ccc;
  stroke: #fff;
  stroke-width: .5px;
} */

path.ocean {
  fill: #cce8fe;
}
path.bathymetryI2000 {
  fill: #b3deff;
}
path.bathymetryG4000 {
  fill: #99d3ff;
}
path.bathymetryE6000 {
  fill: #80c8ff;
}
path.bathymetryC8000 {
  fill: #66bdff;
}

path.countries {
  fill: #ddc;
}

path.countries.countyColor_1 {
  fill: #fbb4ae;
}
path.countries.countyColor_2 {
  fill: #ccebc5;
}
path.countries.countyColor_3 {
  fill: #decbe4;
}
path.countries.countyColor_4 {
  fill: #fed9a6;
}
path.countries.countyColor_5 {
  fill: #ffffcc;
}
path.countries.countyColor_6 {
  fill: #fddaec;
}
path.countries.countyColor_7 {
  fill: #e5d8bd;
}

path.countries.Antarctica {
  fill: #ddd;
}

path.glaciated {
  fill: #fffc;
}

path.rivers {
  fill: #0000;
  fill-opacity: 0;
  stroke: #ddf;
  stroke-width: .5px;
}

path.lakes {
  fill: #ddf;
  stroke: #fff;
  stroke-width: .5px;
}

path.countriesTopLines {
  fill: #0000;
  stroke: #0004;
  stroke-width: .5px;
}

path.graticules {
  fill: #0000;
  stroke: #eee;
  stroke-width: .5px;
}

path.graticules.degrees_0 {
  fill: #0000;
  stroke: #eee;
  stroke-width: 1px;
}

path.geographicLines {
  /*  hide other geographicLines*/
  fill: #0000;
  stroke: #0000;
  stroke-width: 0px;
}

path.geographicLines.scalerank_0 {
  fill: #0000;
  stroke: #eee;
  stroke-width: 1px;
}




</style>

<body>
<script src="https://d3js.org/d3.v4.min.js"></script>
<script src="https://d3js.org/d3-array.v2.min.js"></script>
<script src="https://d3js.org/d3-geo.v2.min.js"></script>
<script src="https://d3js.org/d3-geo-projection.v3.min.js"></script>
<script src="https://unpkg.com/d3-geo-polygon@1"></script>


<script>

//Basics
var width = 960,
    height = 500;

var projection = d3.geoImago();

var path = d3.geoPath()
  .projection(projection)

var svg = d3.select("body").append("svg")
    .attr("width", width)
    .attr("height", height);

//strech
d3.selectAll('svg').attr("transform", "scale(1)");


//URLs for data
var url_ocean =                 "https://raw.githubusercontent.com/nvkelso/natural-earth-vector/master/geojson/ne_110m_ocean.geojson"

var url_bathymetryI2000 =       "https://raw.githubusercontent.com/nvkelso/natural-earth-vector/master/geojson/ne_10m_bathymetry_I_2000.geojson"
var url_bathymetryG4000 =       "https://raw.githubusercontent.com/nvkelso/natural-earth-vector/master/geojson/ne_10m_bathymetry_G_4000.geojson"
var url_bathymetryE6000 =       "https://raw.githubusercontent.com/nvkelso/natural-earth-vector/master/geojson/ne_10m_bathymetry_E_6000.geojson"
var url_bathymetryC8000 =       "https://raw.githubusercontent.com/nvkelso/natural-earth-vector/master/geojson/ne_10m_bathymetry_C_8000.geojson"

var url_countries =             "https://raw.githubusercontent.com/nvkelso/natural-earth-vector/master/geojson/ne_110m_admin_0_countries.geojson";
var url_glaciated =             "https://raw.githubusercontent.com/nvkelso/natural-earth-vector/master/geojson/ne_110m_glaciated_areas.geojson"
var url_rivers =                "https://raw.githubusercontent.com/nvkelso/natural-earth-vector/master/geojson/ne_110m_rivers_lake_centerlines.geojson"
var url_lakes =                 "https://raw.githubusercontent.com/nvkelso/natural-earth-vector/master/geojson/ne_110m_lakes.geojson"
var url_graticules =            "https://raw.githubusercontent.com/nvkelso/natural-earth-vector/master/geojson/ne_10m_graticules_10.geojson"
var url_geographicLines =       "https://raw.githubusercontent.com/nvkelso/natural-earth-vector/master/geojson/ne_110m_geographic_lines.geojson"

var url_places =                "https://raw.githubusercontent.com/nvkelso/natural-earth-vector/master/geojson/ne_110m_populated_places_simple.geojson"


//Layers in draw order (top layer will be last listed)
var layer_ocean = svg.append('g');
var layer_bathymetryI2000 = svg.append('g');
var layer_bathymetryG4000 = svg.append('g');
var layer_bathymetryE6000 = svg.append('g');
var layer_bathymetryC8000 = svg.append('g');
var layer_countries = svg.append('g');
var layer_glaciated = svg.append('g');
var layer_rivers = svg.append('g');
var layer_lakes = svg.append('g');
var layer_countriesTopLines = svg.append('g');
var layer_graticules = svg.append('g');
var layer_geographicLines = svg.append('g');



//Add data to map
d3.json(url_ocean, function(error, ocean) {
d3.json(url_bathymetryI2000, function(error, bathymetryI2000) {
d3.json(url_bathymetryG4000, function(error, bathymetryG4000) {
d3.json(url_bathymetryE6000, function(error, bathymetryE6000) {
d3.json(url_bathymetryC8000, function(error, bathymetryC8000) {
d3.json(url_countries, function(error, countries) {
d3.json(url_glaciated, function(error, glaciated) {
d3.json(url_rivers, function(error, rivers) {
d3.json(url_lakes, function(error, lakes) {
d3.json(url_countries, function(error, countriesTopLines) {
d3.json(url_graticules, function(error, graticules) {
d3.json(url_geographicLines, function(error, geographicLines) {

  if (error) console.log(error);

  layer_ocean.selectAll("path")
    .data(ocean.features)
  .enter().append("path")
    .attr("d", path)
    .attr("class", "ocean")

  layer_bathymetryI2000.selectAll("path")
    .data(bathymetryI2000.features)
  .enter().append("path")
    .attr("d", path)
    .attr("class", "bathymetryI2000")

  layer_bathymetryG4000.selectAll("path")
    .data(bathymetryG4000.features)
  .enter().append("path")
    .attr("d", path)
    .attr("class", "bathymetryG4000")

  layer_bathymetryE6000.selectAll("path")
    .data(bathymetryE6000.features)
  .enter().append("path")
    .attr("d", path)
    .attr("class", "bathymetryE6000")

  layer_bathymetryC8000.selectAll("path")
    .data(bathymetryC8000.features)
  .enter().append("path")
    .attr("d", path)
    .attr("class", "bathymetryC8000")

  layer_countries.selectAll("path")
    .data(countries.features)
  .enter().append("path")
    .attr("d", path)
    .attr("class", function(d) { return "countries countyColor_"+d.properties.MAPCOLOR7+" "+d.properties.NAME})

  layer_glaciated.selectAll("path")
    .data(glaciated.features)
  .enter().append("path")
    .attr("d", path)
    .attr("class", "glaciated")

  layer_rivers.selectAll("path")
    .data(rivers.features)
  .enter().append("path")
    .attr("d", path)
    .attr("class", "rivers")

  layer_lakes.selectAll("path")
    .data(lakes.features)
  .enter().append("path")
    .attr("d", path)
    .attr("class", "lakes")

  layer_countriesTopLines.selectAll("path")
    .data(countriesTopLines.features)
  .enter().append("path")
    .attr("d", path)
    .attr("class", "countriesTopLines")

  layer_graticules.selectAll("path")
    .data(graticules.features)
  .enter().append("path")
    .attr("d", path)
    .attr("class", function(d) { return "graticules degrees_"+d.properties.degrees})

  layer_geographicLines.selectAll("path")
    .data(geographicLines.features)
  .enter().append("path")
    .attr("d", path)
    .attr("class", function(d) { return "geographicLines scalerank_"+d.properties.scalerank})


})
})
})
})
})
})
})
})
})
})
})
});


</script>

<!--
To export
1) load page (10 seconds or more)
2) open console
3) run these commands:

function saveSvg(svgEl, name) {
    svgEl.setAttribute("xmlns", "http://www.w3.org/2000/svg");
    var svgData = svgEl.outerHTML;
    var preface = '<?xml version="1.0" standalone="no"?>\r\n';
    var svgBlob = new Blob([preface, svgData], {type:"image/svg+xml;charset=utf-8"});
    var svgUrl = URL.createObjectURL(svgBlob);
    var downloadLink = document.createElement("a");
    downloadLink.href = svgUrl;
    downloadLink.download = name;
    document.body.appendChild(downloadLink);
    downloadLink.click();
    document.body.removeChild(downloadLink);
};
saveSvg(document.getElementsByTagName("svg")[0], 'test.svg');


-->


<!--
Sources:
https://colorbrewer2.org/#type=qualitative&scheme=Pastel1&n=9
http://bl.ocks.org/almccon/a53831a573911d0a875821c5f9fac6be
https://observablehq.com/@fil/the-imago-projection
https://stackoverflow.com/questions/23218174/how-do-i-save-export-an-svg-file-after-creating-an-svg-with-d3-js-ie-safari-an
 -->
